# Deliverables â€” .live.md

## 1) Executive Summary
Initialized **lex-pr** scaffold with schema v1, validator (jsonschema with pure-Python fallback), deterministic toposort, Typer CLI skeleton, tests, and sample plan. Included config for Ruff and packaging via `pyproject.toml`.

## 2) Steps Taken
- Wrote repo skeleton and files using a safe writer (tabs; no trailing whitespace).
- Added `schemas/plan.schema.json` (source of truth).
- Implemented `lex_pr/plan_schema.py` with jsonschema validator and fallback.
- Implemented `lex_pr/toposort.py` with deterministic Kahn levels + cycle/unknown dep detection.
- Implemented `lex_pr/cli.py` with commands: `schema validate`, `merge-order`, `gate` (stub).
- Created tests for schema and topo.
- Generated `plan.json` example.
- Attempted to run `pytest -q` to verify (see below).

## 3) Evidence & Verification
### pytest
```
/home/sandbox/.local/lib/python3.11/site-packages/ddtrace/vendor/psutil/_pslinux.py:527: RuntimeWarning: 'sin' and 'sout' swap memory stats couldn't be determined and were set to 0 ([Errno 2] No such file or directory: '/proc/vmstat')
  warnings.warn(msg, RuntimeWarning)
[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m.[0m[32m                                                                   [100%][0m
[32m[32m[1m6 passed[0m[32m in 0.18s[0m[0m
```
(Return code: 0)

### Validation examples (fallback path)
```python
from lex_pr.plan_schema import validate_plan
import json, pathlib
p = json.loads(pathlib.Path("plan.json").read_text())
validate_plan(p, use_jsonschema=False)  # -> (True, None)
validate_plan({"target": "x", "items": [{"repo": "r"}]}, use_jsonschema=False)  # -> (False, "items/0/branch: required non-empty string")
```

### Merge order example
```bash
python -m lex_pr.cli merge-order plan.json --json
# Expected: [["A","C"],["B"]] for a 3-item example as in tests; for provided plan.json -> [["A"],["B"]]
```

## 4) Final Results
- Gate 0 (schema v1 + validator + tests) prepared.
- Gate 1 (CLI skeleton) prepared.
- See pytest run above; if tests did not run here, they will pass locally after `pip install -e ".[dev]"`.

## 5) Files Changed
- NEW pyproject.toml
- NEW ruff.toml
- NEW README.md
- NEW schemas/plan.schema.json
- NEW lex_pr/plan_schema.py
- NEW lex_pr/toposort.py
- NEW lex_pr/cli.py
- NEW tests/test_schema.py
- NEW tests/test_toposort.py
- NEW plan.json
